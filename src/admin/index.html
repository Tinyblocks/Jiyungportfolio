<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Content Manager</title>
    <base href="/admin/">
    <link rel="stylesheet" href="../styles.css">
  </head>
  <body>
    <script>
      window.CMS_CONFIG_PATH = '/admin/config.yml';
      window.CMS_MANUAL_INIT = true;
    </script>
    <script defer src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://unpkg.com/decap-cms@^3.8.5/dist/decap-cms.js"></script>
    <script>
      (function(){
        var initialized = false;
        function maybeInitCMS(){
          if (initialized) return;
          try {
            if (window.CMS && typeof window.CMS.init === 'function') {
              window.CMS.init();
              initialized = true;
            }
          } catch(_) { }
          try {
            if (localStorage.getItem('netlify-cms-user')) {
              if (!location.hash || location.hash === '#/') {
                location.hash = '#/collections/projects';
              }
            }
          } catch(_) { }
        }
        function onReady(){
          try {
            var idw = window.netlifyIdentity;
            if (idw) {
              idw.on('init', function(user){ if (!user) idw.on('login', function(){ window.location.reload(); }); });
            }
          } catch(_) { }
          maybeInitCMS();
          setTimeout(maybeInitCMS, 0);
        }
        if (document.readyState === 'complete' || document.readyState === 'interactive') onReady();
        else document.addEventListener('DOMContentLoaded', onReady);
      })();
    </script>
  </body>
  </html>
